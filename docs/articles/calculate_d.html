<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial: Estimate the extent of etiologic heterogeneity • riskclustr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial: Estimate the extent of etiologic heterogeneity">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">riskclustr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Function Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calculate_d.html">Estimate the extent of etiologic heterogeneity</a>
    </li>
    <li>
      <a href="../articles/eh_test.html">Test for etiologic heterogeneity</a>
    </li>
    <li>
      <a href="../articles/optimal_d.html">Identify the optimal D subtype solution</a>
    </li>
    <li>
      <a href="../articles/factor_pvalue.html">Obtain an overall p-value for a factor variable</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/contribute.html">Contribute</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/zabore/riskclustr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Tutorial: Estimate the extent of etiologic heterogeneity</h1>
                        <h4 class="author">Emily C. Zabor</h4>
            
            <h4 class="date">Last updated: August 21, 2019</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/zabore/riskclustr/blob/master/vignettes/calculate_d.Rmd"><code>vignettes/calculate_d.Rmd</code></a></small>
      <div class="hidden name"><code>calculate_d.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This tutorial will introduce you to the calculations underlying estimation of the extent of etiologic heterogeneity in either a case-control or case-only study.</p>
<p>This tutorial will also demonstrate how to use the functions included in this package based on a simulated example dataset named <code>subtype_data</code>. This simulated dataset contains 1200 case subjects and 800 control subjects. Cases are split into four pre-defined etiologically distinct subtypes. There are two continuous risk factors and one binary risk factor available on all subjects.</p>
</div>
<div id="case-control-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#case-control-methods" class="anchor"></a>Case-control methods</h2>
<p>The primary methodology was introduced in detail in:</p>
<blockquote>
<p>Begg CB, Zabor EC, Bernstein JL, Bernstein L, Press MF, Seshan VE. A conceptual and methodological framework for investigating etiologic heterogeneity. <em>Stat Med.</em> 2013;32(29):5039-52.</p>
</blockquote>
<p>The method involves identifying a pre-defined subtype solution involving a set of <span class="math inline">\(M\)</span> disease subtypes, and calculating a measure of etiologic heterogeneity.</p>
<p>In a case-control study, the measure of etiologic heterogeneity is denoted <span class="math inline">\(D\)</span>. To calculate <span class="math inline">\(D\)</span>, one must first perform polytomous logistic regression of the known risk factors for disease on the subtypes and obtain estimated risk predictions from this model for each of the subtypes for each control subject. Since the measure is population-based it is calculated solely using the study controls. Let <span class="math inline">\(i\)</span> denote these control subjects <span class="math inline">\(i=1, \ldots, N_H\)</span>, where <span class="math inline">\(N_H\)</span> denotes the total number of non-diseased control subjects, and let <span class="math inline">\(m\)</span> index the set of disease subtypes, <span class="math inline">\(m=1, \ldots, M\)</span>. The risk predictions obtained from the polytomous logistic regression model for the <span class="math inline">\(i\)</span>th individual are denoted <span class="math inline">\(r_{mi}\)</span> such that the total risk of disease for that individual is <span class="math inline">\(r_i = \sum_{m=1}^M r_{mi}\)</span>. Let the coefficients of variation of the subtype risks in the population be denoted <span class="math inline">\(C_m^2 = v_m / \mu_m^2\)</span> where <span class="math inline">\(v_m = N_H^{-1}\sum_{i=1}^{N_H} r_{mi}^2 - \mu_m^2\)</span> and <span class="math inline">\(\mu_m = N_H^{-1}\sum_{i=1}^{N_H} r_{mi}\)</span>. Let the corresponding total coefficient of variation be denoted <span class="math inline">\(C^2 = v / \mu^2\)</span>, where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(v\)</span> are the overall disease risk mean and variance, respectively. Then the measure of etiologic heterogeneity is defined as</p>
<p><span class="math display">\[D = \sum_{m=1}^M \pi_m C_m^2 - C^2,\]</span></p>
<p>where <span class="math inline">\(\pi_m\)</span> represents the prevalence of the <span class="math inline">\(m\)</span>th disease subtype.</p>
<p>To estimate <span class="math inline">\(D\)</span> in the context of a case-control study, we use the <code><a href="../reference/d.html">d()</a></code> function.<code><a href="../reference/d.html">d()</a></code> relies on the <code>mlogit</code> function from the <code>mlogit</code> package to fit the polytomous logistic regression model. We supply <code><a href="../reference/d.html">d()</a></code> with the name of the subtype variable, the number of subtypes, a list of risk factors, and the dataset name. See the function <a href="http://www.emilyzabor.com/riskclustr/reference/d.html">documentation</a> for details of argument specification.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(riskclustr)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="../reference/d.html">d</a></span>(</span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="dt">label =</span> <span class="st">"subtype"</span>,</span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="dt">M =</span> <span class="dv">4</span>, </span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="dt">factors =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>),</span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="dt">data =</span> subtype_data</span>
<span id="cb1-8"><a href="#cb1-8"></a>)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#&gt; [1] 0.4100995</span></span></code></pre></div>
<p>And we see that using all three risk factors, <span class="math inline">\(D=0.410\)</span> for the four disease subtypes of interest in the case-control setting.</p>
</div>
<div id="case-only-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#case-only-methods" class="anchor"></a>Case-only methods</h2>
<p>When control subjects are not available, then a case-only approximation of <span class="math inline">\(D\)</span>, denoted <span class="math inline">\(D^\ast\)</span>, can be applied. The details of this calculation can be found in:</p>
<blockquote>
<p>Begg CB, Seshan VE, Zabor EC, et al. Genomic investigation of etiologic heterogeneity: methodologic challenges. <em>BMC Med Res Methodol.</em> 2014;14:138.</p>
</blockquote>
<p>Briefly, whereas the variance and covariance terms in the equation for <span class="math inline">\(D\)</span> are averaged over the controls in the case-control setting, in a case-only setting they are averaged over the cases, which represent a risk-biased sample from the population. The goal of an analysis of this type is not to interpret the magnitude of <span class="math inline">\(D^\ast\)</span>, but rather to use <span class="math inline">\(D^\ast\)</span> to rank different subtyping schemes and identify the one that maximizes etiologic heterogeneity.</p>
<p>To demonstrate the usage, we first limit <code>subtype_data</code> to the cases only. Controls are denoted by a <code>0</code> for the <code>subtype</code> variable.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>subtype_cases &lt;-<span class="st"> </span>subtype_data[subtype_data<span class="op">$</span>subtype <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>, ]</span></code></pre></div>
<p>We specify the arguments to <code><a href="../reference/dstar.html">dstar()</a></code> as before for <code><a href="../reference/d.html">d()</a></code>, but supplying our new case-only dataset to the <code>data</code> argument. Now, the subtype variable must be numeric, with cases coded as <span class="math inline">\(1\)</span> through <span class="math inline">\(M\)</span> according to the subtype to which they belong. The highest frequency level of <code>label</code> will be used as the reference level, for model stability.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="../reference/dstar.html">dstar</a></span>(</span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="dt">label =</span> <span class="st">"subtype"</span>,</span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="dt">M =</span> <span class="dv">4</span>, </span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="dt">factors =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>),</span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="dt">data =</span> subtype_cases</span>
<span id="cb3-6"><a href="#cb3-6"></a>)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt; [1] 0.4022017</span></span></code></pre></div>
<p>And we see that using all three risk factors, <span class="math inline">\(D^\ast=0.402\)</span> for the four disease subtypes of interest in the case-only setting.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#case-control-methods">Case-control methods</a></li>
      <li><a href="#case-only-methods">Case-only methods</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Emily C. Zabor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
