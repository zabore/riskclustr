<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial: Estimate the extent of etiologic heterogeneity • riskclustr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial: Estimate the extent of etiologic heterogeneity">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">riskclustr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calculate_d.html">Estimate the extent of etiologic heterogeneity</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/zabore/riskclustr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Tutorial: Estimate the extent of etiologic heterogeneity</h1>
                        <h4 class="author">Emily C. Zabor</h4>
            
            <h4 class="date">Last updated: November 13, 2018</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/zabore/riskclustr/blob/master/vignettes/calculate_d.Rmd"><code>vignettes/calculate_d.Rmd</code></a></small>
      <div class="hidden name"><code>calculate_d.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This tutorial will introduce you to the calculations underlying estimation of the extent of etiologic heterogeneity in either a case-control or case-only study.</p>
<p>This tutorial will also demonstrate how to use the functions included in this package based on a simulated example dataset named <code>subtype_data</code>. This simulated dataset contains 1200 case subjects and 800 control subjects. Cases are split into three pre-defined etiologically distinct subtypes. There are also 30 continuous markers available on the cases that could be used in clustering to identify candidate subtypes. There are two continuous risk factors and one binary risk factor available on all subjects.</p>
</div>
<div id="case-control-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#case-control-methods" class="anchor"></a>Case-control methods</h2>
<p>The primary methodology was introduced in detail in:</p>
<blockquote>
<p>Begg CB, Zabor EC, Bernstein JL, Bernstein L, Press MF, Seshan VE. A conceptual and methodological framework for investigating etiologic heterogeneity. <em>Stat Med.</em> 2013;32(29):5039-52.</p>
</blockquote>
<p>The method involves identifying a pre-defined subtype solution involving a set of <span class="math inline">\(M\)</span> disease subtypes, and calculating a measure of etiologic heterogeneity.</p>
<p>In a case-control study, the measure of etiologic heterogeneity is denoted <span class="math inline">\(D\)</span>. To calculate <span class="math inline">\(D\)</span>, one must first perform polytomous logistic regression of the known risk factors for disease on the subtypes and obtain estimated risk predictions from this model for each of the subtypes for each control subject. Since the measure is population-based it is calculated solely using the study controls. Let <span class="math inline">\(i\)</span> denote these control subjects <span class="math inline">\(i=1, \ldots, N_H\)</span>, where <span class="math inline">\(N_H\)</span> denotes the total number of non-diseased control subjects, and let <span class="math inline">\(m\)</span> index the set of disease subtypes, <span class="math inline">\(m=1, \ldots, M\)</span>. The risk predictions obtained from the polytomous logistic regression model for the <span class="math inline">\(i\)</span>th individual are denoted <span class="math inline">\(r_{mi}\)</span> such that the total risk of disease for that individual is <span class="math inline">\(r_i = \sum_{m=1}^M r_{mi}\)</span>. Let the coefficients of variation of the subtype risks in the population be denoted <span class="math inline">\(C_m^2 = v_m / \mu_m^2\)</span> where <span class="math inline">\(v_m = N_H^{-1}\sum_{i=1}^{N_H} r_{mi}^2 - \mu_m^2\)</span> and <span class="math inline">\(\mu_m = N_H^{-1}\sum_{i=1}^{N_H} r_{mi}\)</span>. Let the corresponding total coefficient of variation be denoted <span class="math inline">\(C^2 = v / \mu^2\)</span>, where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(v\)</span> are the overall disease risk mean and variance. Then the measure of etiologic heterogeneity is defined as</p>
<p><span class="math display">\[D = \sum_{m=1}^M \pi_m C_m^2 - C^2,\]</span></p>
<p>where <span class="math inline">\(\pi_m\)</span> represents the prevalence of the <span class="math inline">\(m\)</span>th disease subtype.</p>
<p>To estimate <span class="math inline">\(D\)</span>, we use the <code><a href="../reference/d.html">d()</a></code> function.</p>
<p>The calculation of <span class="math inline">\(D\)</span> using <code><a href="../reference/d.html">d()</a></code> relies on the <code>mlogit</code> function from the <code>mlogit</code> package to fit the polytomous logistic regression model.</p>
<p>First, we need to specify the model formula using an <code>mFormula</code> object from the <code>mlogit</code> package. For example, we can use the pre-specified numeric <code>subtype</code> variable as the outcome and all three risk factors as predictors.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">mform &lt;-<span class="st"> </span>mlogit<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/mlogit/topics/mFormula">mFormula</a></span>(subtype <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>x3)</a></code></pre></div>
<p>Then we can supply this to the <code>formula</code> argument of <code><a href="../reference/d.html">d()</a></code>, along with specification of the name of the subtype variable, the number of subtypes, and the dataset. Note that the variable name supplied to the <code>label</code> argument must be a quoted string.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(riskclustr)</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="../reference/d.html">d</a></span>(</a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="dt">formula =</span> mform,</a>
<a class="sourceLine" id="cb2-5" title="5">  <span class="dt">label =</span> <span class="st">"subtype"</span>,</a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="dt">M =</span> <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="dt">data =</span> subtype_data</a>
<a class="sourceLine" id="cb2-8" title="8">)</a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; [1] 0.6427697</span></a></code></pre></div>
</div>
<div id="case-only-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#case-only-methods" class="anchor"></a>Case-only methods</h2>
<p>When control subjects are not available, then a case-only approximation of <span class="math inline">\(D\)</span>, denoted <span class="math inline">\(D^\ast\)</span>, can be applied. The details of this calculation can be found in:</p>
<blockquote>
<p>Begg CB, Seshan VE, Zabor EC, et al. Genomic investigation of etiologic heterogeneity: methodologic challenges. <em>BMC Med Res Methodol.</em> 2014;14:138. Published 2014 Dec 22. <a href="doi:10.1186/1471-2288-14-138" class="uri">doi:10.1186/1471-2288-14-138</a></p>
</blockquote>
<p>Briefly, whereas the variance and covariance terms in the equation for <span class="math inline">\(D\)</span> are averaged over the controls in the case-control setting, in a case-only setting they are averaged over the cases, which represent a risk-biased sample from the population. The goal of an analysis of this type is not to interpret the magnitude of <span class="math inline">\(D^\ast\)</span>, but rather to use <span class="math inline">\(D^\ast\)</span> to rank different subtyping schemes and identify the one that maximizes etiologic heterogeneity.</p>
<p>To demonstrate the usage, first let’s limit the <code>subtype_data</code> to the cases only. Controls are denoted by a <code>0</code> for the <code>subtype</code> variable.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">subtype_cases &lt;-<span class="st"> </span>subtype_data[subtype_data<span class="op">$</span>subtype <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>, ]</a></code></pre></div>
<p>We can use the same model formula saved to object <code>mform</code> that was specified for the case-control example, to obtain a case-only estimate of <span class="math inline">\(D^\ast\)</span> for the pre-specified <code>subtype</code> variable and based on all three risk factors.</p>
<p>Then we specify the arguments to <code><a href="../reference/dstar.html">dstar()</a></code> as before, but supplying our new case-only dataset to the <code>data</code> argument.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="../reference/dstar.html">dstar</a></span>(</a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="dt">formula =</span> mform,</a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="dt">label =</span> <span class="st">"subtype"</span>,</a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="dt">M =</span> <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="dt">data =</span> subtype_cases</a>
<a class="sourceLine" id="cb4-6" title="6">)</a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt; [1] 0.5589295</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#case-control-methods">Case-control methods</a></li>
      <li><a href="#case-only-methods">Case-only methods</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Emily C. Zabor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
