<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial: Identify the optimal D subtype solution • riskclustr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial: Identify the optimal D subtype solution">
<meta property="og:description" content="riskclustr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">riskclustr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Function Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calculate_d.html">Estimate the extent of etiologic heterogeneity</a>
    </li>
    <li>
      <a href="../articles/eh_test.html">Test for etiologic heterogeneity</a>
    </li>
    <li>
      <a href="../articles/optimal_d.html">Identify the optimal D subtype solution</a>
    </li>
    <li>
      <a href="../articles/factor_pvalue.html">Obtain an overall p-value for a factor variable</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/contribute.html">Contribute</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/zabore/riskclustr" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tutorial: Identify the optimal D subtype
solution</h1>
                        <h4 data-toc-skip class="author">Emily C.
Zabor</h4>
            
            <h4 data-toc-skip class="date">Last updated: October 19,
2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/zabore/riskclustr/blob/HEAD/vignettes/optimal_d.Rmd" class="external-link"><code>vignettes/optimal_d.Rmd</code></a></small>
      <div class="hidden name"><code>optimal_d.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Sometimes subtypes will not be pre-defined, but rather it will be of
interest to identify subtypes that differ maximally with respect to risk
heterogeneity based on some number of disease markers.</p>
<p>This tutorial will introduce you to the
<code><a href="../reference/optimal_kmeans_d.html">optimal_kmeans_d()</a></code> function, which will run <span class="math inline">\(k\)</span>-means clustering, using the
<code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans()</a></code> function, on disease marker data and identify the
subtype solution that maximizes <span class="math inline">\(D\)</span>.
When <span class="math inline">\(k\)</span>-means clustering is run with
multiple random starts, it will return a variety of class solutions, as
the algorithm typically reaches a local rather than global maxima. Then
for each candidate class solution, <span class="math inline">\(D\)</span> can be computed and the solution that
maximizes <span class="math inline">\(D\)</span>, a measure of etiologic
heterogeneity, can be identified. This function is currently for use
with case-control data only. See <a href="calculate_d.html">Tutorial:
Estimate the extent of etiologic heterogeneity</a> for details on the
calculation of the <span class="math inline">\(D\)</span> value.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This tutorial will make use of a simulated example dataset named
<code>subtype_data</code>. This simulated dataset contains 1200 case
subjects and 800 control subjects. There are 30 continuous disease
markers available on the cases. There are two continuous risk factors
and one binary risk factor available on all subjects.</p>
<p>Say for example that interest was in identifying the optimally
etiologically heterogeneous 3-subtype solution based on all 30 markers
<code>y1</code>-<code>y30</code> available in <code>subtype_data</code>,
using all three risk factors <code>x1</code>, <code>x2</code> and
<code>x3</code>. We use the default of 100 random starts of the <span class="math inline">\(k\)</span>-means clustering algorithm, and set a
seed so that results would be reproduced if we were to run this code
again on a later date. Note that this function is currently a bit slow
to run due to the fitting of numerous models, so please be patient.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.emilyzabor.me/riskclustr/">riskclustr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimal_kmeans_d.html">optimal_kmeans_d</a></span><span class="op">(</span></span>
<span>  markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  factors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span><span class="op">)</span>,</span>
<span>  case <span class="op">=</span> <span class="st">"case"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">subtype_data</span>,</span>
<span>  nstart <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">81110224</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `data_frame()` was deprecated in tibble 1.1.0.</span></span>
<span><span class="co">#&gt; Please use `tibble()` instead.</span></span></code></pre></div>
<p>The function returns a list with one element for the optimal <span class="math inline">\(D\)</span> value and one element that is the
original data frame with a column added for the optimal <span class="math inline">\(D\)</span> class solution.</p>
<p>First let’s look at a tabulation of <code>optimal_d_label</code> from
the <code>optimal_d_data</code> object to see how each case was
classified into a subtype:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">res</span><span class="op">[[</span><span class="st">"optimal_d_data"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">optimal_d_label</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   0   1   2   3 </span></span>
<span><span class="co">#&gt; 800 301 300 599</span></span></code></pre></div>
<p>These subtype labels could now be used as the outcome in a polytomous
logistic regression model fit with <code><a href="../reference/eh_test_subtype.html">eh_test_subtype()</a></code> to
obtain measures of risk factor association as well as heterogeneity
<span class="math inline">\(p\)</span>-values. See <a href="eh_test.html">Tutorial: test for etiologic heterogeneity in a
case-control study</a> for details.</p>
<p>Next we can see the <span class="math inline">\(D\)</span> value that
goes long with the optimal subtype solution:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span><span class="op">[[</span><span class="st">"optimal_d"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.3385876</span></span></code></pre></div>
<p>We see that this optimal 3-subtype solution based on clustering the
30 disease markers results in <span class="math inline">\(D=0.339\)</span>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Emily C. Zabor.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
